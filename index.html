<!DOCTYPE html>
<html>
<head>
  <!-- Cargar el script de Niubiz -->
  <script src="https://static-content-qas.vnforapps.com/env/sandbox/js/checkout.js" onload="initializeCheckout()" onerror="handleScriptError()"></script>
</head>
<body>
  <!-- Formulario de pago -->
  <form id="checkoutForm"
    action="https://www.tuweb.com/respuesta"
    method="POST"
    data-sessiontoken=""
    data-channel="web"
    data-merchantid="456879852"
    data-purchasenumber=""
    data-amount=""
    data-expirationminutes="10"
    data-timeouturl="https://www.tuweb.com/timeout"
    data-merchantlogo="https://www.tuweb.com/logo.png"
    data-merchantname="Tu Comercio"
    data-buttonsize="MEDIUM"
    data-buttoncolor="NAVY"
    data-formbuttoncolor="#FF0000"
    data-showamount="TRUE"
  >
  </form>

  <script>
    // Función que se ejecuta cuando el script de Niubiz se ha cargado correctamente
    function initializeCheckout() {
      console.log('Script de Niubiz cargado correctamente.');

      // Leer parámetros de la URL
      const params = new URLSearchParams(window.location.search);

      // Establecer los atributos del formulario con los parámetros de la URL
      document.getElementById('checkoutForm').setAttribute('data-sessiontoken', params.get('sessionToken') || '');
      document.getElementById('checkoutForm').setAttribute('data-purchasenumber', params.get('purchaseNumber') || '');
      document.getElementById('checkoutForm').setAttribute('data-amount', params.get('amount') || '');

      // Verificar si el objeto Checkout está disponible y luego abrir el formulario
      if (typeof Checkout !== 'undefined') {
        Checkout.open(); // Abre el formulario de pago
      } else {
        console.error('El objeto Checkout no está definido. Verifica si el script de Niubiz se cargó correctamente.');
      }
    }

    // Función para manejar errores en el script de Niubiz
    function handleScriptError() {
      console.error('Hubo un error al cargar el script de Niubiz.');
    }
  </script>
</body>
</html>
